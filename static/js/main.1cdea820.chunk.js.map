{"version":3,"sources":["store/reducers/userReducer.ts","store/actionTypes.ts","store/reducers/annotationReducer.ts","store/reducers/articleReducer.ts","store/reducers/colorReducer.ts","store/reducers/utilityReducer.ts","store/dataTypes.ts","store/actions.ts","store/selectors/colorSelector.ts","store/selectors/articleSelector.ts","store/selectors/userSelector.ts","store/selectors/annotationSelector.ts","store/selectors/utilitySelector.ts","store/index.ts","config.ts","utils/getResource.ts","utils/addBackgroundCss.ts","utils/addClass.tsx","utils/getColorClassName.ts","utils/getHighlightStyle.ts","utils/createHighlightStyle.ts","socket.ts","utils/hotKeys.ts","components/AnnotationPanel.tsx","components/QuestionCard.tsx","components/SentenceCard.tsx","components/Annotator.tsx","components/ColorLegend.tsx","components/Sentence.tsx","components/Article.tsx","components/ArticleCard.tsx","components/ArticleCardPanel.tsx","components/CategoryPanel.tsx","components/SetUsername.tsx","App.tsx","serviceWorker.ts","index.tsx"],"names":["userReducer","state","action","type","Cookies","set","username","areAnnotationsEqual","a","b","articleId","sentenceIndex","annotator","category","annotationReducer","i","length","annotation","slice","defaultState","loadedArticles","categoryToArticleIdListMap","articleReducer","article","id","articleIds","paragraphIndex","sentences","paragraphToSentences","annotatorToColorMap","annotatorToAnnotatorsMap","existingCombinations","colorReducer","color","includes","className","utilityReducer","categories","selectedSentence","selectedText","setCurrentArticleAction","currentArticle","displayOthersAnnotation","setCategoryListAction","allColors","setCurrentArticle","addAnnotation","rank","removeAnnotation","getColorState","store","colors","getAllColors","createSelector","getExistingCombinations","getArticleState","articles","getCategoryToArticleIdListMap","getLoadedArticles","getArticleIdList","map","getLastArticleId","list","index","indexOf","getNextArticleId","getArticle","getSentence","undefined","getUsername","isUserLoggedIn","getAnnotationState","annotations","getArticleAnnotations","utils","others","filter","getAnnotations","isSentenceChecked","getUtilityState","getCurrentArticle","getSelectedSentence","shouldSentenceScrollIntoView","sentenceIn","selectedIn","initialState","get","reducer","combineReducers","createStore","applyMiddleware","thunk","frontend","getResource","location","loc","startsWith","addBackgroundCss","head","document","getElementsByTagName","style","createElement","innerHTML","appendChild","addClass","styles","getAlphabeticString","input","str","encoded","encodeURIComponent","replace","getColorClassName","annotators","_","isString","uniq","sort","join","getHighlightStyle","c","used","key","Math","floor","random","dispatch","createHighlightStyle","doesColorsExistInDocument","getState","highlightStyle","addColorsToDocument","socket","socketIOClient","fetchArticleList","emit","on","selectSentenceWithOffset","offset","sentence","min","max","deselectSentence","goToArticleWithOffset","idList","window","history","pushState","hotKeyMap","ENTER","MOVE_UP","MOVE_DOWN","DESELECT","LAST_ARTICLE","NEXT_ARTICLE","hotKeyHandlers","isChecked","connector","connect","AnnotationPanel","this","onRouteChanged","prevProps","props","leaveArticle","match","params","scrollTo","keyMap","handlers","React","Component","withRouter","mapStateToProps","QuestionCard","question","explanation","checked","shouldScrollIntoView","changeSelectedText","divRef","createRef","handleClick","handleContextMenu","e","preventDefault","setTimeout","prev","current","scrollIntoView","behavior","classList","add","remove","ref","onClick","onContextMenu","annotatedSentences","anns","lastArticleId","nextArticleId","updateAnnotationRank","Annotator","goToLastArticle","push","goToNextArticle","result","destination","source","destSentenceIndex","annotationIndex","newRank","destIndex","neighborSentenceIndex","count","ann","onDragEnd","bind","droppableId","provided","droppableProps","innerRef","draggableId","draggableProps","dragHandleProps","outline","placeholder","visibility","ColorLegend","plainText","actionName","parentElement","scrollToSentenceInPlainView","parent","contains","offsetTop","classNames","getClassName","ownProps","addArticle","updateParagraphToSentencesMap","Promise","resolve","blockContextMenu","event","paragraph","displayOnly","temp","trim","start","end","paragraphs","getParagraph","ArticleCard","hasRenderedInFull","shouldNotRenderInFull","setState","backgroundColor","ArticleCardPanel","columnCount","getArticleCard","columnIndex","rowIndex","isVisible","display","justifyContent","alignItems","width","annotatedArticleCount","updateAnnotatedArticleCount","height","to","padding","textDecoration","position","top","zIndex","right","cellRenderer","columnWidth","rowHeight","rowCount","ceil","setUsername","handleChange","changeUsername","target","value","onKeyPress","onChange","App","path","component","CategoryPanel","Boolean","hostname","baseUrl","URL","ReactDOM","render","basename","pathname","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.1cdea820.chunk.js","sourcesContent":["import Cookies from 'js-cookie';\nimport { CHANGE_USERNAME, ChangeUsernameActionType } from '../actionTypes';\n\nfunction userReducer(state: string = '', action: ChangeUsernameActionType) {\n  if (action.type === CHANGE_USERNAME) {\n    Cookies.set('username', action.username);\n    return action.username;\n  }\n\n  return state;\n}\n\nexport default userReducer;;\n","import { ArticleType, AnnotationType } from './dataTypes';\n\nexport const ADD_ARTICLE = 'ADD_ARTICLE';\nexport const REMOVE_ARTICLE = 'REMOVE_ARTICLE';\nexport const UPDATE_CATEGORY_ARTICLE_LIST = 'UPDATE_CATEGORY_ARTICLE_LIST';\nexport const UPDATE_PARAGRAPH_TO_SENTENCES = 'UPDATE_PARAGRAPH_TO_SENTENCES';\n\nexport const ADD_ANNOTATION = 'ADD_ANNOTATION';\nexport const REMOVE_ANNOTATION = 'REMOVE_ANNOTATION';\nexport const UPDATE_ANNOTATION_RANK = 'UPDATE_ANNOTATION_RANK';\n\nexport const CHANGE_COLOR = 'CHANGE_COLOR';\nexport const ADD_COLORS_TO_DOCUMENT = 'ADD_COLORS_TO_DOCUMENT';\n\nexport const CHANGE_USERNAME = 'CHANGE_USERNAME';\n\nexport const CHANGE_SELECTED_TEXT = 'CHANGE_SELECTED_TEXT';\nexport const SET_CURRENT_ARTICLE = 'SET_CURRENT_ARTICLE';\nexport const DISPLAY_OTHERS_ANNOTATION = 'DISPLAY_OTHERS_ANNOTATION';\nexport const SET_CATEGORY_LIST = 'SET_CATEGORY_LIST';\n\n/**\n * User\n */\nexport type ChangeUsernameActionType = {\n  type: typeof CHANGE_USERNAME\n  username: string\n}\n\n/**\n * Article\n */\nexport type AddArticleActionType = {\n  type: typeof ADD_ARTICLE\n  article: ArticleType\n}\n\nexport type RemoveArticleActionType = {\n  type: typeof REMOVE_ARTICLE\n  article: ArticleType\n}\n\nexport type UpdateCategoryArticleListActionType = {\n  type: typeof UPDATE_CATEGORY_ARTICLE_LIST\n  category: string\n  articleIds: number[]\n}\n\nexport type UpdateParagraphToSentencesActionType = {\n  type: typeof UPDATE_PARAGRAPH_TO_SENTENCES\n  article: ArticleType,\n  paragraphIndex: number,\n  sentences: number[],\n}\n\nexport type LoadedArticleActionType = AddArticleActionType | RemoveArticleActionType;\nexport type ArticleActionType = LoadedArticleActionType\n  | UpdateCategoryArticleListActionType\n  | UpdateParagraphToSentencesActionType;\n\n/**\n * Annotation\n */\nexport type AddAnnotationActionType = {\n  type: typeof ADD_ANNOTATION\n  annotation: AnnotationType\n}\n\nexport type RemoveAnnotationActionType = {\n  type: typeof REMOVE_ANNOTATION\n  annotation: AnnotationType\n}\n\nexport type UpdateAnnotationRankActionType = {\n  type: typeof UPDATE_ANNOTATION_RANK\n  annotation: AnnotationType\n}\n\nexport type AnnotationActionType = AddAnnotationActionType\n  | RemoveAnnotationActionType\n  | UpdateAnnotationRankActionType;\n\n/**\n * Color\n */\nexport type ChangeColorActionType = {\n  type: typeof CHANGE_COLOR\n  username: string\n  color: string\n}\n\nexport type AddColorsToDocumentActionType = {\n  type: typeof ADD_COLORS_TO_DOCUMENT\n  className: string\n}\n\nexport type ColorActionType = ChangeColorActionType | AddColorsToDocumentActionType;\n\n/**\n * Utility\n */\nexport type ChangeSelectedTextActionType = {\n  type: typeof CHANGE_SELECTED_TEXT\n  selectedText: {\n    articleId: number\n    category: string\n    sentenceIndex: number\n    selectedIn: 'ARTICLE_SECTION' | 'ANNOTATION_SECTION' | 'HOT_KEY' | 'DESELECT'\n  }\n}\n\nexport type SetCurrentArticleActionType = {\n  type: typeof SET_CURRENT_ARTICLE\n  articleId: number\n  category: string\n}\n\nexport type DisplayOthersAnnotationActionType = {\n  type: typeof DISPLAY_OTHERS_ANNOTATION\n}\n\nexport type SetCategoryListActionType = {\n  type: typeof SET_CATEGORY_LIST\n  categories: string[]\n}\n\nexport type UtilityActionType = ChangeSelectedTextActionType\n  | SetCurrentArticleActionType\n  | DisplayOthersAnnotationActionType\n  | SetCategoryListActionType;\n","import { AnnotationType } from '../dataTypes';\nimport {\n  ADD_ANNOTATION, REMOVE_ANNOTATION, UPDATE_ANNOTATION_RANK,\n  AnnotationActionType,\n} from '../actionTypes';\n\nfunction areAnnotationsEqual(a: AnnotationType, b: AnnotationType) {\n  return a.articleId === b.articleId\n    && a.sentenceIndex === b.sentenceIndex\n    && a.annotator === b.annotator\n    && a.category === b.category;\n}\n\nfunction annotationReducer(state: AnnotationType[] = [], action: AnnotationActionType) {\n  switch (action.type) {\n    case ADD_ANNOTATION:\n      for (let i = 0; i < state.length; i++) {\n        if (areAnnotationsEqual(action.annotation, state[i])) return state;\n      }\n      return [...state, action.annotation];\n\n    case REMOVE_ANNOTATION:\n      for (let i = 0; i < state.length; i++) {\n        if (areAnnotationsEqual(action.annotation, state[i])) {\n          return [...state.slice(0, i), ...state.slice(i + 1)];\n        }\n      }\n      break;\n    case UPDATE_ANNOTATION_RANK:\n      const { annotation } = action;\n      for (let i = 0; i < state.length; i++) {\n        if (areAnnotationsEqual(annotation, state[i])) {\n          return [...state.slice(0, i), annotation, ...state.slice(i + 1)];\n        }\n      }\n      break;\n  }\n  return state;\n}\n\nexport default annotationReducer;\n","import { ArticleStateType, ArticleType } from '../dataTypes';\nimport {\n  ADD_ARTICLE, REMOVE_ARTICLE, UPDATE_CATEGORY_ARTICLE_LIST,\n  ArticleActionType, LoadedArticleActionType, UpdateCategoryArticleListActionType,\n  UPDATE_PARAGRAPH_TO_SENTENCES, UpdateParagraphToSentencesActionType,\n} from '../actionTypes';\n\nconst defaultState: ArticleStateType = {\n  loadedArticles: [],\n  categoryToArticleIdListMap: {},\n};\n\nfunction articleReducer(state: ArticleStateType = defaultState, action: ArticleActionType) {\n  let article: ArticleType;\n\n  switch (action.type) {\n    case ADD_ARTICLE:\n      article = (action as LoadedArticleActionType).article;\n      for (let i = 0; i < state.loadedArticles.length; i++) {\n        if (state.loadedArticles[i].id === article.id &&\n          state.loadedArticles[i].category === article.category) {\n          return {\n            ...state,\n            loadedArticles: [\n              ...state.loadedArticles.slice(0, i),\n              article,\n              ...state.loadedArticles.slice(i + 1),\n            ],\n          };\n        }\n      }\n      return {\n        ...state,\n        loadedArticles: [...state.loadedArticles, article],\n      };\n\n    case REMOVE_ARTICLE:\n      article = (action as LoadedArticleActionType).article;\n      for (let i = 0; i < state.loadedArticles.length; i++) {\n        if (state.loadedArticles[i] === article) {\n          return {\n            ...state,\n            loadedArticles: [...state.loadedArticles.slice(0, i), ...state.loadedArticles.slice(i + 1)],\n          };\n        }\n      }\n      break;\n    \n    case UPDATE_CATEGORY_ARTICLE_LIST:\n      const { category, articleIds } = action as UpdateCategoryArticleListActionType;\n      return {\n        ...state,\n        categoryToArticleIdListMap: {\n          ...state.categoryToArticleIdListMap,\n          [category]: articleIds,\n        },\n      };\n\n    case UPDATE_PARAGRAPH_TO_SENTENCES:\n      article = (action as UpdateParagraphToSentencesActionType).article;\n      const { paragraphIndex, sentences } = action as UpdateParagraphToSentencesActionType;\n      for (let i = 0; i < state.loadedArticles.length; i++) {\n        let a = state.loadedArticles[i];\n        if (a.id === article.id && a.category === article.category) {\n          a = { ...a };\n          a.paragraphToSentences = a.paragraphToSentences || [];\n          a.paragraphToSentences[paragraphIndex] = sentences;\n          return {\n            ...state,\n            loadedArticles: [\n              ...state.loadedArticles.slice(0, i),\n              a,\n              ...state.loadedArticles.slice(i + 1),\n            ],\n          };\n        }\n      }\n  }\n\n  return state;\n}\n\nexport default articleReducer;\n","import { ADD_COLORS_TO_DOCUMENT, CHANGE_COLOR, ColorActionType } from '../actionTypes';\nimport { ColorsType } from '../dataTypes';\n\nconst defaultState: ColorsType = {\n  annotatorToColorMap: {},\n  annotatorToAnnotatorsMap: {},\n  existingCombinations: [],\n};\n\nfunction colorReducer(state: ColorsType = defaultState, action: ColorActionType) {\n  switch (action.type) {\n    case CHANGE_COLOR:\n      const { username, color } = action;\n      return {\n        ...state,\n        annotatorToColorMap: {\n          ...state.annotatorToColorMap,\n          [username]: color,\n        },\n      };\n    case ADD_COLORS_TO_DOCUMENT:\n      if (!state.existingCombinations.includes(action.className)) {\n        return {\n          ...state,\n          existingCombinations: [...state.existingCombinations, action.className],\n        };\n      }\n  }\n  return state;\n}\n\nexport default colorReducer;\n","import {\n  CHANGE_SELECTED_TEXT, SET_CURRENT_ARTICLE,\n  DISPLAY_OTHERS_ANNOTATION, SET_CATEGORY_LIST,\n  UtilityActionType, SetCurrentArticleActionType, SetCategoryListActionType,\n} from '../actionTypes';\nimport { UtilityType } from '../dataTypes';\n\nfunction utilityReducer(state: UtilityType = { categories: [] }, action: UtilityActionType) {\n  switch (action.type) {\n    case CHANGE_SELECTED_TEXT:\n      return {\n        ...state,\n        selectedSentence: action.selectedText,\n      };\n    case SET_CURRENT_ARTICLE:\n      const setCurrentArticleAction = action as SetCurrentArticleActionType;\n      const { articleId, category } = setCurrentArticleAction;\n      return {\n        ...state,\n        currentArticle: { articleId, category },\n      };\n    case DISPLAY_OTHERS_ANNOTATION:\n      return {\n        ...state,\n        displayOthersAnnotation: !state.displayOthersAnnotation,\n      };\n    case SET_CATEGORY_LIST:\n      const setCategoryListAction = action as SetCategoryListActionType;\n      return {\n        ...state,\n        categories: setCategoryListAction.categories,\n      } as UtilityType;\n  }\n  return state;\n}\n\nexport default utilityReducer;\n","export type ArticleType = {\n  id: number;\n  category: string;\n  article: string;\n  question: string;\n  explanation: string;\n  answer: number;\n  paragraphs: string[];\n  sentences: string[];\n  checkedSentences: number[];\n  annotations?: AnnotationType[];\n  paragraphToSentences?: number[][];\n}\n\nexport type AnnotationType = {\n  articleId: number;\n  category: string;\n  sentenceIndex: number;\n  annotator: string;\n  rank?: number;\n}\n\nexport type ColorsType = {\n  annotatorToColorMap: Record<string, string>,\n  annotatorToAnnotatorsMap: Record<string, string[]>,\n  existingCombinations: string[],\n};\n\nexport const allColors = [\n  'rgb(169, 222, 204)',\n  'rgb(255, 227, 134)',\n  'rgb(214, 157, 177)',\n  'rgba(0, 181, 204, 1)',\n  'rgb(226, 106, 106)',\n  'rgb(190, 144, 212)',\n  'rgb(141, 195, 234)',\n  'rgb(215, 186, 229)',\n  'rgb(140, 20, 252)',\n  'rgb(241, 169, 160)',\n  'rgb(145, 61, 136)',\n  'rgb(118, 93, 105)',\n  'rgb(154, 18, 179)',\n];\n\nexport type ArticleStateType = {\n  categoryToArticleIdListMap: Record<string, number[]>;\n  loadedArticles: ArticleType[];\n};\n\nexport type UtilityType = {\n  selectedSentence?: {\n    articleId: number;\n    category: string;\n    sentenceIndex: number;\n    selectedIn: 'ARTICLE_SECTION' | 'ANNOTATION_SECTION' | 'HOT_KEY' | 'DESELECT';\n  },\n  currentArticle?: {\n    articleId: number;\n    category: string;\n  },\n  displayOthersAnnotation?: boolean,\n  categories: [],\n}\n\nexport type StateType = {\n  username?: string;\n  colors: ColorsType;\n  articles: ArticleStateType;\n  annotations: AnnotationType[];\n  utils: UtilityType;\n}\n","import {\n  CHANGE_USERNAME,\n  ChangeUsernameActionType,\n  ADD_COLORS_TO_DOCUMENT,\n  AddColorsToDocumentActionType,\n  ADD_ANNOTATION,\n  AddAnnotationActionType,\n  REMOVE_ANNOTATION,\n  RemoveAnnotationActionType,\n  SET_CURRENT_ARTICLE,\n  SetCurrentArticleActionType,\n} from './actionTypes';\n\nexport function changeUsername(username: string): ChangeUsernameActionType {\n  return {\n    type: CHANGE_USERNAME,\n    username,\n  };\n}\n\nexport function setCurrentArticle(articleId: number, category: string): SetCurrentArticleActionType {\n  return {\n    type: SET_CURRENT_ARTICLE,\n    articleId,\n    category,\n  };\n}\n\nexport function addColorsToDocument(className: string): AddColorsToDocumentActionType {\n  return {\n    type: ADD_COLORS_TO_DOCUMENT,\n    className,\n  };\n}\n\nexport function addAnnotation(\n  articleId: number,\n  category: string,\n  sentenceIndex: number,\n  annotator: string,\n  rank: number = 0): AddAnnotationActionType {\n  return {\n    type: ADD_ANNOTATION,\n    annotation: {\n      articleId,\n      category,\n      sentenceIndex,\n      annotator,\n      rank,\n    }\n  }\n}\n\nexport function removeAnnotation(\n  articleId: number,\n  category: string,\n  sentenceIndex: number,\n  annotator: string): RemoveAnnotationActionType {\n  return {\n    type: REMOVE_ANNOTATION,\n    annotation: {\n      articleId,\n      category,\n      sentenceIndex,\n      annotator,\n    }\n  }\n}\n","import { StateType } from '../dataTypes';\nimport { createSelector } from 'reselect';\n\nexport const getColorState = (store: StateType) => store.colors;\n\nexport const getAllColors = createSelector(\n  getColorState,\n  state => state.annotatorToColorMap,\n);\n\nexport const getAnnotatorColors = (annotators: string[]) => createSelector(\n  getAllColors,\n  colorState => {\n    const colors: Record<string, string> = {};\n    for (const annotator of annotators) {\n      colors[annotator] = colorState[annotator];\n    }\n    return colors;\n  },\n);\n\nexport const getExistingCombinations = createSelector(\n  getColorState,\n  state => state.existingCombinations,\n);\n\nexport const doesColorsExistInDocument = (className: string) => createSelector(\n  getExistingCombinations,\n  state => state.includes(className),\n);\n","import { StateType } from '../dataTypes';\nimport { createSelector } from 'reselect';\n\nexport const getArticleState = (store: StateType) => {\n  return store.articles;\n}\n\nexport const getCategoryToArticleIdListMap = createSelector(\n  getArticleState,\n  state => state.categoryToArticleIdListMap,\n);\n\nexport const getLoadedArticles = createSelector(\n  getArticleState,\n  state => state.loadedArticles,\n);\n\nexport const getArticleIdList = (category: string) => createSelector(\n  getCategoryToArticleIdListMap,\n  map => map[category],\n);\n\nexport const getLastArticleId = (articleId: number, category: string) => createSelector(\n  getArticleIdList(category),\n  list => {\n    if (!list) return -1;\n    const index = list.indexOf(articleId);\n    if (index <= 0) return -1;\n    return list[index - 1];\n  },\n);\n\nexport const getNextArticleId = (articleId: number, category: string) => createSelector(\n  getArticleIdList(category),\n  list => {\n    if (!list) return -1;\n    const index = list.indexOf(articleId);\n    if (index < 0 || index + 1 === list.length) return -1;\n    return list[index + 1];\n  },\n);\n\nexport const getArticle = (id: number, category: string) => createSelector(\n  getLoadedArticles,\n  articles => {\n    for (const article of articles) {\n      if (article.id === id && article.category === category) {\n        return article;\n      }\n    }\n    return undefined;\n  }\n);\n\nexport const getSentence = (articleId: number, category: string, sentenceIndex: number) => createSelector(\n  getArticle(articleId, category),\n  article => {\n    if (article === undefined) return;\n    return article.sentences[sentenceIndex];\n  }\n);\n","import { StateType } from '../dataTypes';\nimport { createSelector } from 'reselect';\n\nexport const getUsername = (store: StateType) => {\n  return store.username;\n}\n\nexport const isUserLoggedIn = createSelector(\n  getUsername,\n  username => username !== undefined && username.length > 0,\n);\n","import { StateType } from '../dataTypes';\nimport { getUsername } from './userSelector';\nimport { createSelector } from 'reselect';\nimport _ from 'lodash';\n\nexport const getAnnotationState = (store: StateType) => {\n  return store.annotations;\n}\n\nexport const getArticleAnnotations = (articleId: number, category: string) => createSelector(\n  getAnnotationState,\n  (state: StateType) => state.utils.displayOthersAnnotation,\n  getUsername,\n  (annotations, others, username) => annotations.filter(annotation => (\n    annotation.articleId === articleId\n    && annotation.category === category\n    && (others || annotation.annotator === username)\n  )),\n);\n\nexport const getArticleAnnotators = (articleId: number, category: string) => createSelector(\n  getArticleAnnotations(articleId, category),\n  getUsername,\n  (annotations, username) => {\n    const annotators = annotations\n      .map(a => a.annotator)\n      .filter(a => a !== username);\n    annotators.push(username || '');\n    return _.uniq(annotators);\n  },\n)\n\nexport const getAnnotations = (articleId: number, category: string, sentenceIndex: number) => createSelector(\n  getArticleAnnotations(articleId, category),\n  annotations => annotations.filter(annotation => annotation.sentenceIndex === sentenceIndex),\n);\n\nexport const isSentenceChecked = (articleId: number, category: string, sentenceIndex: number) => createSelector(\n  getUsername,\n  getAnnotations(articleId, category, sentenceIndex),\n  (username, annotations) => {\n    for (const annotation of annotations) {\n      if (annotation.annotator === username)\n        return true;\n    }\n    return false;\n  }\n);\n\nexport const getAnnotatedSentences = (articleId: number, category: string) => createSelector(\n  getArticleAnnotations(articleId, category),\n  getUsername,\n  (annotations, username) => {\n    const anns = annotations\n      .filter(a => a.articleId === articleId && a.category === category)\n      .sort((a, b) => {\n        if ((a.annotator === username) !== (b.annotator === username))\n          return a.annotator === username ? -1 : 1;\n        if (a.rank !== b.rank)\n          return (b.rank || 0) - (a.rank || 0);\n        return a.sentenceIndex - b.sentenceIndex;\n      })\n      .map(a => a.sentenceIndex);\n    return _.uniq(anns);\n  },\n);\n\nexport const getAnnotators = (articleId: number, category: string, sentenceIndex: number) => createSelector(\n  getAnnotations(articleId, category, sentenceIndex),\n  annotations => annotations.map(annotation => annotation.annotator),\n);\n","import { StateType } from '../dataTypes';\n\nexport const getUtilityState = (store: StateType) => {\n  return store.utils;\n}\n\nexport const getCurrentArticle = (store: StateType) => {\n  return getUtilityState(store).currentArticle;\n}\n\nexport const getSelectedSentence = (store: StateType) => {\n  return getUtilityState(store).selectedSentence;\n}\n\nexport const shouldSentenceScrollIntoView = (\n  store: StateType,\n  articleId: number,\n  category: string,\n  sentenceIndex: number,\n  sentenceIn: 'ARTICLE_SECTION' | 'ANNOTATION_SECTION' | 'HOT_KEY' | 'DESELECT'\n) => {\n  const utils = getUtilityState(store);\n  if (!utils.selectedSentence) return false;\n  const { selectedSentence } = utils;\n  if (selectedSentence.selectedIn === 'DESELECT') return false;\n  return selectedSentence.articleId === articleId\n    && selectedSentence.sentenceIndex === sentenceIndex\n    && selectedSentence.category === category\n    && sentenceIn !== selectedSentence.selectedIn;\n}\n","import { createStore, combineReducers, applyMiddleware } from 'redux';\nimport thunk from 'redux-thunk';\nimport { StateType } from './dataTypes';\nimport userReducer from './reducers/userReducer';\nimport annotationReducer from './reducers/annotationReducer';\nimport articleReducer from './reducers/articleReducer';\nimport colorReducer from './reducers/colorReducer';\nimport utilityReducer from './reducers/utilityReducer';\nimport Cookies from 'js-cookie';\n\nexport * from './dataTypes';\nexport * from './actionTypes';\nexport * from './actions';\nexport * from './selectors';\nexport * from './reducers';\n\nconst initialState: StateType = {\n  username: Cookies.get('username'),\n  colors: {\n    annotatorToColorMap: {},\n    annotatorToAnnotatorsMap: {},\n    existingCombinations: [],\n  },\n  articles: {\n    categoryToArticleIdListMap: {},\n    loadedArticles: [],\n  },\n  annotations: [],\n  utils: {\n    categories: [],\n  },\n};\n\nconst reducer = combineReducers({\n  username: userReducer,\n  annotations: annotationReducer,\n  articles: articleReducer,\n  colors: colorReducer,\n  utils: utilityReducer,\n});\n\nexport default createStore(reducer, initialState, applyMiddleware(thunk));\n","export const frontend = 'https://annotator.zehua.li/';\nexport const backend = 'https://backend.annotator.zehua.li/';\n","import { frontend } from '../config';\n\nfunction getResource(location: string) {\n  let loc = location;\n  if (loc.startsWith('/')) loc = loc.slice(1);\n  return `${frontend}${loc}`;\n}\n\nexport default getResource;\n","import getResource from './getResource';\n\nfunction addBackgroundCss() {\n  const head = document.getElementsByTagName('head')[0];\n  const style = document.createElement('style');\n  style.type = 'text/css';\n  style.innerHTML = `\n    html, body, #root, .sentence-card-background {\n      background-image: url(${getResource('paper.jpg')});\n    }\n  `;\n  head.appendChild(style);\n}\n\nexport default addBackgroundCss;\n","function addClass(className: string, styles: string) {\n  if (styles.length === 0) return;\n  const head = document.getElementsByTagName('head')[0];\n  const style = document.createElement('style');\n  style.type = 'text/css';\n  style.innerHTML = `.${className} {${styles}}`;\n  head.appendChild(style);\n}\n\nexport default addClass;\n","import _ from 'lodash';\n\nfunction getAlphabeticString(input: string) {\n  let str = '';\n  for (let i = 0; i < input.length; i++) {\n    if (input[i] >= 'a' && input[i] <= 'z') str += input[i];\n    else if (input[i] >= 'A' && input[i] <= 'Z') str += input[i];\n    else {\n      let encoded = encodeURIComponent(input[i]);\n      while (encoded.indexOf('%') >= 0) {\n        encoded = encoded.replace('%', '---');\n      }\n      str += encoded;\n    }\n  }\n  return str;\n}\n\nfunction getColorClassName(annotators: string[] | string) {\n  if (_.isString(annotators)) annotators = [annotators];\n  if (annotators.length === 0) return '';\n  annotators = _.uniq(annotators).sort();\n  return `highlight-${annotators.map(getAlphabeticString).join('-')}`;\n}\n\nexport default getColorClassName;\n","import _ from 'lodash';\nimport store, { CHANGE_COLOR, allColors } from '../store';\n\nfunction getHighlightStyle(colors: Record<string, string>, annotators: string[] | string) {\n  if (_.isString(annotators)) annotators = [annotators];\n  if (annotators.length === 0) return '';\n  annotators = _.uniq(annotators).sort();\n\n  for (const annotator of annotators) {\n    if (!colors[annotator]) {\n      let c;\n      for (const color of allColors) {\n        let used = false;\n        for (const key in colors) {\n          if (colors[key] === color) {\n            used = true;\n            break;\n          }\n        }\n        if (!used) {\n          c = color;\n          break;\n        }\n      }\n\n      if (!c) c = allColors[Math.floor(Math.random() * allColors.length)];\n\n      store.dispatch({\n        type: CHANGE_COLOR,\n        username: annotator,\n        color: c,\n      });\n      colors[annotator] = c;\n    }\n  }\n\n  let style = 'background-image: linear-gradient(';\n  if (annotators.length === 1) {\n    const color = colors[annotators[0]];\n    style += `transparent 0px, transparent 50%, ${color} 0px, ${color});`\n    return style;\n  }\n\n  for (let i = 0; i < annotators.length; i++) {\n    const annotator = annotators[i];\n    const color = colors[annotator];\n    style += `${color} 0px, ${color} ${(i + 1) * 100 / annotators.length}%`;\n    if (annotators.indexOf(annotator) !== annotators.length - 1) {\n      style += ',';\n    } else {\n      style += ');'\n    }\n  }\n  return style;\n}\n\nexport default getHighlightStyle;\n","import addClass from './addClass';\nimport getColorClassName from './getColorClassName';\nimport getHighlightStyle from './getHighlightStyle';\nimport store, { addColorsToDocument, doesColorsExistInDocument, getAllColors } from '../store';\n\nfunction createHighlightStyle(annotators: string[] | string) {\n  const className = getColorClassName(annotators);\n  if (doesColorsExistInDocument(className)(store.getState())) return;\n  const highlightStyle = getHighlightStyle(getAllColors(store.getState()), annotators);\n  addClass(className, highlightStyle);\n  store.dispatch(addColorsToDocument(className));\n}\n\nexport default createHighlightStyle;\n","import socketIOClient from 'socket.io-client';\nimport store, {\n  AnnotationType, UPDATE_CATEGORY_ARTICLE_LIST,\n  UPDATE_ANNOTATION_RANK, SET_CATEGORY_LIST,\n  addAnnotation, removeAnnotation,\n} from './store';\nimport { backend } from './config';\n\nconst socket = socketIOClient(backend);\n\nexport const fetchCategoryList = () => {\n  socket.emit('refresh category list', (categories: string[]) => {\n    store.dispatch({\n      type: SET_CATEGORY_LIST,\n      categories,\n    });\n  });\n};\n\nexport const fetchArticleList = (category: string) => {\n  socket.emit('refresh article list', { category }, (articleIds: number[]) => {\n    store.dispatch({\n      type: UPDATE_CATEGORY_ARTICLE_LIST,\n      category,\n      articleIds,\n    });\n  });\n};\n\nsocket.on('add annotation', (annotation: AnnotationType) => {\n  const { articleId, category, annotator, sentenceIndex } = annotation;\n  store.dispatch(addAnnotation(articleId, category, sentenceIndex, annotator));\n});\n\nsocket.on('remove annotation', (annotation: AnnotationType) => {\n  const { articleId, category, annotator, sentenceIndex } = annotation;\n  store.dispatch(removeAnnotation(articleId, category, sentenceIndex, annotator));\n});\n\nsocket.on('update annotation rank', (annotation: AnnotationType) => {\n  store.dispatch({\n    type: UPDATE_ANNOTATION_RANK,\n    annotation,\n  });\n});\n\nexport default socket;\n","import store, {\n  getSelectedSentence, isSentenceChecked, getUsername,\n  addAnnotation, removeAnnotation, getCurrentArticle, getArticleIdList,\n  ChangeSelectedTextActionType, CHANGE_SELECTED_TEXT, setCurrentArticle,\n  getArticle,\n} from '../store';\nimport socket from '../socket';\n\nconst toggleAnnotationForCurrentSentence = () => {\n  const sentence = getSelectedSentence(store.getState());\n  if (!sentence || sentence.articleId < 0) return;\n\n  const username = getUsername(store.getState());\n  if (!username) return;\n\n  const { articleId, category, sentenceIndex} = sentence;\n  const isChecked = isSentenceChecked(articleId, category, sentenceIndex)(store.getState());\n  if (isChecked) {\n    store.dispatch(removeAnnotation(articleId, category, sentenceIndex, username));\n  } else {\n    store.dispatch(addAnnotation(articleId, category, sentenceIndex, username));\n  }\n  socket.emit(`${isChecked ? 'remove' : 'add'} annotation`, {\n    ...sentence,\n    annotator: username,\n    rank: 0,\n  });\n};\n\nconst selectPreviousSentence = () => selectSentenceWithOffset(-1);\nconst selectNextSentence = () => selectSentenceWithOffset(1);\n\nconst selectSentenceWithOffset = (offset: number) => {\n  const article = getCurrentArticle(store.getState());\n  if (!article) return;\n  const a = getArticle(article.articleId, article.category)(store.getState());\n  if (!a) return;\n  const sentences = a.sentences;\n  let sentence = getSelectedSentence(store.getState());\n  if (!sentence || sentence.articleId !== article.articleId || sentence.articleId < 0) {\n    sentence = {\n      ...article,\n      sentenceIndex: -offset,\n      selectedIn: 'HOT_KEY',\n    };\n  }\n\n  sentence.sentenceIndex += offset;\n  sentence.sentenceIndex = Math.min(sentences.length - 1, sentence.sentenceIndex);\n  sentence.sentenceIndex = Math.max(0, sentence.sentenceIndex);\n  sentence.selectedIn = 'HOT_KEY';\n\n  deselectSentence();\n  store.dispatch({\n    type: CHANGE_SELECTED_TEXT,\n    selectedText: sentence,\n  } as ChangeSelectedTextActionType);\n};\n\nconst deselectSentence = () => {\n  let sentence = getSelectedSentence(store.getState());\n  if (sentence) {\n    return store.dispatch({\n      type: CHANGE_SELECTED_TEXT,\n      selectedText: { ...sentence, selectedIn: 'DESELECT' },\n    } as ChangeSelectedTextActionType);\n  }\n\n  store.dispatch({\n    type: CHANGE_SELECTED_TEXT,\n    selectedText: { articleId: -1, category: '', sentenceIndex: -1, selectedIn: 'DESELECT' },\n  } as ChangeSelectedTextActionType);\n}\n\nconst goToLastArticle = () => goToArticleWithOffset(-1);\nconst goToNextArticle = () => goToArticleWithOffset(1);\n\nconst goToArticleWithOffset = (offset: number) => {\n  const article = getCurrentArticle(store.getState());\n  if (!article) return;\n  const idList = getArticleIdList(article.category)(store.getState());\n  let index = idList.indexOf(article.articleId) + offset;\n  index = Math.min(idList.length - 1, index);\n  index = Math.max(0, index);\n  store.dispatch(setCurrentArticle(idList[index], article.category));\n  window.history.pushState(null, '', `/article-annotator/${article.category}/${idList[index]}`);\n}\n\nexport const hotKeyMap = {\n  ENTER: ['enter', 'k'],\n  MOVE_UP: ['w', 'h'],\n  MOVE_DOWN: ['s', 'j'],\n  DESELECT: ['q', 'l'],\n  LAST_ARTICLE: ['[', 'y'],\n  NEXT_ARTICLE: [']', 'u'],\n};\n\nexport const hotKeyHandlers = {\n  ENTER: toggleAnnotationForCurrentSentence,\n  MOVE_UP: selectPreviousSentence,\n  MOVE_DOWN: selectNextSentence,\n  DESELECT: deselectSentence,\n  LAST_ARTICLE: goToLastArticle,\n  NEXT_ARTICLE: goToNextArticle,\n};\n","import React from 'react';\nimport { Dispatch } from 'redux';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { GlobalHotKeys } from 'react-hotkeys';\nimport { hotKeyMap, hotKeyHandlers } from '../utils';\nimport { StateType, setCurrentArticle, getCurrentArticle, isUserLoggedIn } from '../store';\nimport { Article, Annotator } from '.';\nimport socket from '../socket';\n\nconst mapStateToProps = (state: StateType) => ({\n  articleId: getCurrentArticle(state)?.articleId,\n  category: getCurrentArticle(state)?.category,\n  isUserLoggedIn: isUserLoggedIn(state),\n});\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  setCurrentArticle: (articleId: number, category: string) => {\n    dispatch(setCurrentArticle(articleId, category));\n  },\n});\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\ntype PropsType = RouteComponentProps & PropsFromRedux;\n\nclass AnnotationPanel extends React.Component<PropsType> {\n  componentDidMount() {\n    this.onRouteChanged();\n  }\n\n  componentDidUpdate(prevProps: PropsType) {\n    if (this.props.location !== prevProps.location) {\n      this.onRouteChanged();\n    }\n  }\n\n  onRouteChanged() {\n    this.leaveArticle();\n    const { match } = this.props;\n    const articleId: number = +(match.params as any)['articleId'];\n    const category: string = (match.params as any)['category'];\n    this.props.setCurrentArticle(articleId, category);\n    socket.emit('join article', { articleId, category });\n    window.scrollTo(0, 0);\n  }\n\n  leaveArticle() {\n    if (this.props.articleId && this.props.category) {\n      const { articleId, category } = this.props;\n      socket.emit('leave article', { articleId, category });\n    }\n  }\n\n  render() {\n    if (!this.props.articleId || !this.props.category)\n      return <div className=\"annotation-panel-container\" />;\n    const { articleId, category } = this.props;\n    return (\n      <div className=\"annotation-panel-container\">\n        <Article articleId={articleId} category={category} />\n        <Annotator articleId={articleId} category={category} />\n        <GlobalHotKeys keyMap={hotKeyMap} handlers={hotKeyHandlers} />\n      </div>\n    );\n  }\n}\n\nexport default withRouter(connector(AnnotationPanel));\n","import React from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { StateType, getArticle } from '../store';\n\ntype QuestionCardProps = {\n  articleId: number;\n  category: string;\n}\n\nconst mapStateToProps = (state: StateType, props: QuestionCardProps) => ({\n  article: getArticle(props.articleId, props.category)(state),\n});\n\nconst connector = connect(mapStateToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nclass QuestionCard extends React.Component<QuestionCardProps & PropsFromRedux, {}> {\n  render() {\n    if (!this.props.article) return <div />;\n    const { question, explanation } = this.props.article;\n    return (\n      <p className=\"explanation\">\n        <b><i>{question}</i></b><br />\n        {explanation}\n      </p>\n    );\n  }\n}\n\nexport default connect(mapStateToProps)(QuestionCard);\n","import React, { MouseEvent } from 'react';\nimport { Dispatch } from 'redux';\nimport { connect, ConnectedProps } from 'react-redux';\nimport scrollIntoView from 'scroll-into-view-if-needed';\nimport {\n  StateType,\n  getSentence, isSentenceChecked, getUsername, shouldSentenceScrollIntoView,\n  ADD_ANNOTATION, REMOVE_ANNOTATION, CHANGE_SELECTED_TEXT,\n} from '../store';\nimport socket from '../socket';\n\nconst section = 'ANNOTATION_SECTION';\n\nconst mapStateToProps = (state: StateType, props: SentenceCardProps) => ({\n  sentence: getSentence(props.articleId, props.category, props.sentenceIndex)(state),\n  checked: isSentenceChecked(props.articleId, props.category, props.sentenceIndex)(state),\n  username: getUsername(state),\n  shouldScrollIntoView: shouldSentenceScrollIntoView(\n    state,\n    props.articleId,\n    props.category,\n    props.sentenceIndex,\n    section,\n  ),\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  addAnnotation: (articleId: number, category: string, sentenceIndex: number, annotator: string) => {\n    dispatch({\n      type: ADD_ANNOTATION,\n      annotation: {\n        articleId, category, sentenceIndex, annotator,\n      },\n    });\n  },\n  removeAnnotation: (articleId: number, category: string, sentenceIndex: number, annotator: string) => {\n    dispatch({\n      type: REMOVE_ANNOTATION,\n      annotation: {\n        articleId, category, sentenceIndex, annotator,\n      },\n    });\n  },\n  changeSelectedText: (articleId: number, category: string, sentenceIndex: number) => {\n    dispatch({\n      type: CHANGE_SELECTED_TEXT,\n      selectedText: {\n        articleId,\n        category,\n        sentenceIndex,\n        selectedIn: section,\n      },\n    });\n  },\n});\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ntype SentenceCardProps = {\n  articleId: number;\n  category: string;\n  sentenceIndex: number;\n  index?: number;\n}\n\ntype PropsType = SentenceCardProps & PropsFromRedux;\n\nclass SentenceCard extends React.Component<PropsType, {}> {\n  divRef = React.createRef<HTMLDivElement>();\n\n  componentDidUpdate(prev: PropsType) {\n    if (prev.shouldScrollIntoView === this.props.shouldScrollIntoView) return;\n    if (this.props.shouldScrollIntoView) {\n      if (!this.divRef || !this.divRef.current) return;\n      scrollIntoView(this.divRef.current, { behavior: 'smooth' });\n      this.divRef.current.classList.add('selected-sentence-card');\n      setTimeout(() => this.divRef.current?.classList.remove('selected-sentence-card'), 1500);\n    }\n  }\n\n  handleClick = () => {\n    if (!this.props.username) return;\n    const { articleId, category, sentenceIndex, username } = this.props; \n    if (this.props.checked) {\n      this.props.removeAnnotation(articleId, category, sentenceIndex, username);\n    } else {\n      this.props.addAnnotation(articleId, category, sentenceIndex, username);\n    }\n    socket.emit(\n      this.props.checked ? 'remove annotation' : 'add annotation',\n      { articleId, category, sentenceIndex, annotator: username },\n    );\n  }\n\n  handleContextMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    const { articleId, category, sentenceIndex } = this.props;\n    this.props.changeSelectedText(-1, '', -1);\n    setTimeout(() => this.props.changeSelectedText(articleId, category, sentenceIndex), 0);\n  }\n\n  render() {\n    return (\n      <div\n        ref={this.divRef}\n        onClick={this.handleClick}\n        onContextMenu={this.handleContextMenu}\n        className={`sentence-card ${this.props.checked ? 'checked' : ''}`}>\n        <p>{this.props.sentence}</p>\n        <div className=\"side\"><span>{this.props.index}</span></div>\n        <div className=\"sentence-card-background\" />\n      </div>\n    )\n  }\n}\n\nexport default connector(SentenceCard);\n","import React from 'react';\nimport { Dispatch } from 'redux';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { DragDropContext, Droppable, Draggable, DropResult } from 'react-beautiful-dnd';\nimport {\n  StateType, AnnotationType, addAnnotation,\n  getArticleAnnotations, getUsername, UPDATE_ANNOTATION_RANK,\n  getAnnotatedSentences, getLastArticleId, getNextArticleId,\n} from '../store';\nimport socket, { fetchArticleList } from '../socket';\nimport QuestionCard from './QuestionCard';\nimport SentenceCard from './SentenceCard';\n\ntype AnnotatorProps = {\n  articleId: number,\n  category: string,\n}\n\nconst mapStateToProps = (state: StateType, props: AnnotatorProps) => ({\n  annotatedSentences: getAnnotatedSentences(props.articleId, props.category)(state),\n  lastArticleId: getLastArticleId(props.articleId, props.category)(state),\n  nextArticleId: getNextArticleId(props.articleId, props.category)(state),\n  annotations: getArticleAnnotations(props.articleId, props.category)(state),\n  username: getUsername(state),\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  updateAnnotationRank: (annotation: AnnotationType) => {\n    dispatch({\n      type: UPDATE_ANNOTATION_RANK,\n      annotation,\n    });\n  },\n  addAnnotation: (articleId: number, category: string, sentenceIndex: number, username: string) => {\n    dispatch(addAnnotation(articleId, category, sentenceIndex, username));\n  },\n});\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\ntype PropsType = AnnotatorProps & PropsFromRedux & RouteComponentProps;\n\nclass Annotator extends React.Component<PropsType, {}> {\n  ref = React.createRef<HTMLDivElement>();\n\n  componentDidMount() {\n    if (this.props.lastArticleId < 0 && this.props.nextArticleId < 0) {\n      fetchArticleList(this.props.category);\n    }\n  }\n\n  componentDidUpdate(prevProps: PropsType) {\n    if (prevProps.articleId !== this.props.articleId\n      || prevProps.category !== this.props.category) {\n      if (this.ref && this.ref.current) {\n        this.ref.current.scrollTo(0, 0);\n      }\n    }\n  }\n\n  goToLastArticle = () => {\n    const { category, history, lastArticleId } = this.props;\n    if (lastArticleId < 0) return;\n    history.push(`/${category}/${lastArticleId}`);\n  }\n\n  goToNextArticle = () => {\n    const { category, history, nextArticleId } = this.props;\n    if (nextArticleId < 0) return;\n    history.push(`/${category}/${nextArticleId}`);\n  }\n\n  onDragEnd(result: DropResult) {\n    if (!result.destination) return;\n    const sentenceIndex = this.props.annotatedSentences[result.source.index];\n    const destSentenceIndex = this.props.annotatedSentences[result.destination.index];\n\n    let annotationIndex = null;\n    for (let i = 0; i < this.props.annotations.length; i++) {\n      const annotation = this.props.annotations[i];\n      if (sentenceIndex === annotation.sentenceIndex\n        && annotation.annotator === this.props.username) {\n        annotationIndex = i;\n        break;\n      }\n    }\n    if (annotationIndex === null) {\n      if (!this.props.username) return;\n      this.props.addAnnotation(\n        this.props.articleId,\n        this.props.category,\n        sentenceIndex,\n        this.props.username,\n      );\n    }\n\n    if (sentenceIndex === destSentenceIndex) return;\n\n    let newRank = null;\n    const destIndex = result.destination.index;\n    let neighborSentenceIndex = -1;\n    if (destIndex !== 0 && destIndex !== this.props.annotatedSentences.length - 1) {\n      neighborSentenceIndex = result.source.index > destIndex\n        ? this.props.annotatedSentences[destIndex - 1]\n        : this.props.annotatedSentences[destIndex + 1];\n    }\n    let count = 0;\n    for (let i = 0; i < this.props.annotations.length && count < 2; i++) {\n      const annotation = this.props.annotations[i];\n      if ([destSentenceIndex, neighborSentenceIndex].includes(annotation.sentenceIndex)\n        && annotation.annotator === this.props.username) {\n        newRank = (newRank || 0) + (annotation.rank || 1) / 2;\n        count++;\n      }\n    }\n\n    if (newRank === null) return;\n    if (destIndex === 0) {\n      if (count < 1) return;\n      newRank = 2 * newRank + 1024;\n    } else if (destIndex === this.props.annotatedSentences.length - 1) {\n      if (count < 1) return;\n    } else if (count < 2) return;\n\n    const ann = {\n      articleId: this.props.articleId,\n      category: this.props.category,\n      sentenceIndex: sentenceIndex,\n      annotator: this.props.username || '',\n      rank: newRank,\n    };\n\n    this.props.updateAnnotationRank(ann);\n    socket.emit('update annotation rank', ann);\n  }\n\n  render() {\n    return (\n      <div className=\"annotator-container\" ref={this.ref}>\n        <QuestionCard articleId={this.props.articleId} category={this.props.category} />\n        <h3>Select sentences that are relative to the question.</h3>\n\n        <DragDropContext onDragEnd={this.onDragEnd.bind(this)}>\n          <Droppable droppableId=\"annotation-list\">\n            {(provided) => (\n              <div\n                {...provided.droppableProps}\n                ref={provided.innerRef}>\n                {(this.props.annotatedSentences || []).map((sentenceIndex, index) => (\n                  <Draggable\n                    key={`sentence-card-${sentenceIndex}`}\n                    draggableId={`sentence-${sentenceIndex}`}\n                    index={index}>\n                    {(provided) => (\n                      <div\n                        ref={provided.innerRef}\n                        {...provided.draggableProps}\n                        {...provided.dragHandleProps}\n                        style={{ outline: 0, ...provided.draggableProps.style }}>\n                        <SentenceCard\n                          articleId={this.props.articleId}\n                          category={this.props.category}\n                          sentenceIndex={sentenceIndex}\n                          index={index + 1} />\n                      </div>\n                    )}\n                  </Draggable>\n                ))}\n                {provided.placeholder}\n              </div>\n            )}\n          </Droppable>\n        </DragDropContext>\n        <div className=\"last-next-buttons\">\n          <span\n            onClick={this.goToLastArticle}\n            className=\"last-article-button\"\n            style={this.props.lastArticleId < 0 ? {visibility: 'hidden'} : {}}\n          >\n            Last Article\n          </span>\n          <span\n            onClick={this.goToNextArticle}\n            className=\"next-article-button\"\n            style={this.props.nextArticleId < 0 ? {visibility: 'hidden'} : {}}\n          >\n            Next Article\n          </span>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(connector(Annotator));\n","import React from 'react';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport { createHighlightStyle, getColorClassName } from '../utils';\n\ntype ColorLegendProps = {\n  articleId: string;\n  annotators: string[];\n}\ntype PropsType = ColorLegendProps & RouteComponentProps;\n\nclass ColorLegend extends React.Component<PropsType> {\n  componentDidUpdate(prev: PropsType) {\n    if (prev.annotators !== this.props.annotators) {\n      for (const annotator of this.props.annotators) {\n        createHighlightStyle(annotator);\n      }\n    }\n  }\n\n  handleClick = () => {\n    const { history, match } = this.props;\n    const category: string = (match.params as any).category;\n    history.push(`/${category}`);\n  }\n\n  render() {\n    return (\n      <p className=\"legends\">\n        <span onClick={this.handleClick}>Go Back</span>\n        {this.props.annotators.map(annotator => (\n          <span className={getColorClassName([annotator])} key={annotator}>\n            {annotator}\n          </span>\n        ))}\n      </p>\n    );\n  }\n}\n\nexport default withRouter(ColorLegend);\n","import React, { MouseEvent } from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport scrollIntoView from 'scroll-into-view-if-needed';\nimport {\n  StateType, getSelectedSentence,\n  getSentence, getAnnotators, getUsername, addAnnotation, removeAnnotation,\n  shouldSentenceScrollIntoView, CHANGE_SELECTED_TEXT, ChangeSelectedTextActionType,\n} from '../store';\nimport { getColorClassName, createHighlightStyle } from '../utils';\nimport socket from '../socket';\n\ntype SentenceProps = {\n  sentenceIndex: number;\n  articleId: number;\n  category: string;\n  plainText?: boolean;\n}\n\nconst section = 'ARTICLE_SECTION';\n\nconst mapStateToProps = (state: StateType, props: SentenceProps) => ({\n  sentence: getSentence(props.articleId, props.category, props.sentenceIndex)(state),\n  annotators: getAnnotators(props.articleId, props.category, props.sentenceIndex)(state),\n  username: getUsername(state),\n  selectedSentence: getSelectedSentence(state),\n  shouldScrollIntoView: props.plainText ? null : shouldSentenceScrollIntoView(\n    state,\n    props.articleId,\n    props.category,\n    props.sentenceIndex,\n    section,\n  ),\n});\n\nconst connector = connect(mapStateToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\ntype PropsType = SentenceProps & PropsFromRedux\n\nclass Sentence extends React.Component<PropsType> {\n  ref = React.createRef<HTMLSpanElement>();\n\n  componentDidMount() {\n    this.scrollToSentenceInPlainView();\n  }\n\n  componentDidUpdate(prev: PropsType) {\n    this.scrollToSentenceInPlainView();\n    if (prev.shouldScrollIntoView === this.props.shouldScrollIntoView) return;\n    if (this.props.shouldScrollIntoView) {\n      if (!this.ref || !this.ref.current) return;\n      scrollIntoView(this.ref.current, { behavior: 'smooth' });\n      const isHotKeyTriggered = this.props.selectedSentence?.selectedIn === 'HOT_KEY';\n      if (!isHotKeyTriggered) {\n        this.ref.current.classList.add('selected-sentence');\n        setTimeout(() => this.ref.current?.classList.remove('selected-sentence'), 1500);\n      }\n    }\n  }\n\n  scrollToSentenceInPlainView() {\n    setTimeout(() => {\n      if (this.props.plainText && this.props.annotators.length > 0\n        && this.ref && this.ref.current) {\n        if (this.ref.current.parentElement === null) return;\n        let parent: HTMLElement = this.ref.current.parentElement;\n        while (!parent.classList.contains('article-container')) {\n          if (parent.parentElement === null) return;\n          parent = parent.parentElement;\n        }\n\n        parent.scrollTo(0, this.ref.current.offsetTop - 100);\n      }\n    }, 0);\n  }\n\n  handleClick = () => {\n    if (!this.props.annotators || !this.props.username) return;\n    if (!this.props.dispatch) return;\n    const { articleId, category, sentenceIndex, username } = this.props;\n    let actionName = 'remove annotation';\n    if (this.props.annotators.includes(this.props.username)) {\n      this.props.dispatch(removeAnnotation(articleId, category, sentenceIndex, username));\n    } else {\n      actionName = 'add annotation';\n      this.props.dispatch(addAnnotation(articleId, category, sentenceIndex, username));\n    }\n    socket.emit(actionName, { articleId, category, sentenceIndex, annotator: username, rank: 0 });\n  }\n\n  handleContextMenu = (e: MouseEvent) => {\n    e.preventDefault();\n    const { articleId, category, sentenceIndex } = this.props;\n    this.props.dispatch({\n      type: CHANGE_SELECTED_TEXT,\n      selectedText: { articleId: -1, category: '', sentenceIndex: -1, selectedIn: section },\n    } as ChangeSelectedTextActionType);\n    setTimeout(() => {\n      this.props.dispatch({\n        type: CHANGE_SELECTED_TEXT,\n        selectedText: { articleId, category, sentenceIndex, selectedIn: section },\n      } as ChangeSelectedTextActionType);\n    }, 0);\n    if (this.props.annotators.length === 0) {\n      this.ref.current?.parentElement?.parentElement?.classList.add('shakey-sentence');\n      setTimeout(() => {\n        this.ref.current?.parentElement?.parentElement?.classList.remove('shakey-sentence');\n      }, 1000);\n    }\n  }\n\n  getClassName() {\n    const classNames = [getColorClassName(this.props.annotators || [])];\n    if (this.props.shouldScrollIntoView\n      && this.props.selectedSentence?.selectedIn === 'HOT_KEY') {\n      classNames.push('hotkey-selected-sentence');\n    }\n    return classNames.join(' ');\n  }\n\n  render() {\n    if (this.props.plainText) {\n      return (\n        <span\n          ref={this.ref}\n          className={getColorClassName(this.props.annotators || [])}>\n          {this.props.sentence}\n          {createHighlightStyle(this.props.annotators || [])}\n        </span>\n      );\n    }\n\n    return (\n      <span\n        ref={this.ref}\n        onClick={this.handleClick}\n        onContextMenu={this.handleContextMenu}\n        className={this.getClassName()}>\n        {this.props.sentence}\n        {createHighlightStyle(this.props.annotators || [])}\n      </span>\n    );\n  }\n}\n\nexport default connector(Sentence);\n","import React, { MouseEvent } from 'react';\nimport { Dispatch } from 'redux';\nimport { connect, ConnectedProps } from 'react-redux';\nimport socket from '../socket';\nimport ColorLegend from './ColorLegend';\nimport Sentence from './Sentence';\nimport {\n  StateType, ArticleType, UPDATE_PARAGRAPH_TO_SENTENCES,\n  getArticle, addAnnotation, ADD_ARTICLE, getArticleAnnotators,\n} from '../store';\n\ntype ArticleProps = {\n  articleId: number,\n  category: string,\n  displayOnly?: boolean,\n}\n\nconst mapStateToProps = (state: StateType, ownProps: ArticleProps) => ({\n  article: getArticle(ownProps.articleId, ownProps.category)(state),\n  annotators: getArticleAnnotators(ownProps.articleId, ownProps.category)(state),\n});\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  addAnnotation: (article: ArticleType, sentenceIndex: number, annotator: string, rank?: number) => {\n    dispatch(addAnnotation(article.id, article.category, sentenceIndex, annotator, rank));\n  },\n  addArticle: (article: ArticleType) => {\n    dispatch({\n      type: ADD_ARTICLE,\n      article,\n    });\n  },\n  updateParagraphToSentencesMap: (article: ArticleType, paragraphIndex: number, sentences: number[]) => {\n    dispatch({\n      type: UPDATE_PARAGRAPH_TO_SENTENCES,\n      article,\n      paragraphIndex,\n      sentences,\n    });\n  },\n});\n\nconst connector = connect(mapStateToProps, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\ntype PropsType = ArticleProps & PropsFromRedux;\n\nclass Article extends React.Component<PropsType, {}> {\n  ref = React.createRef<HTMLDivElement>();\n\n  componentDidMount() {\n    this.getArticle();\n  }\n\n  async componentDidUpdate(prevProps: PropsType) {\n    if (prevProps.articleId !== this.props.articleId ||\n      prevProps.category !== this.props.category) {\n      await this.getArticle();\n      if (this.ref && this.ref.current) {\n        this.ref.current.scrollTo(0, 0);\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    socket.emit('leave article', {\n      articleId: this.props.articleId,\n      category: this.props.category,\n    });\n  }\n\n  getArticle = async () => {\n    return new Promise((resolve) => {\n      socket.emit('get article', {\n        articleId: this.props.articleId,\n        category: this.props.category,\n      }, (article: ArticleType) => {\n        this.props.addArticle(article);\n        for (const annotation of article.annotations || []) {\n          this.props.addAnnotation(article, annotation.sentenceIndex, annotation.annotator, annotation.rank);\n        }\n        resolve();\n      });\n    });\n  }\n\n  getParagraph(paragraph: string, index: number) {\n    if (!this.props.article) return;\n    let sentences: number[] = [];\n    const { article, articleId, category, displayOnly } = this.props;\n\n    if (this.props.article.paragraphToSentences && this.props.article.paragraphToSentences[index]) {\n      sentences = this.props.article.paragraphToSentences[index];\n    } else {\n      let temp = paragraph.trim();\n      let start = -1;\n      let end = -1;\n      for (let i = 0; i < this.props.article.sentences.length; i++) {\n        if (temp.startsWith(this.props.article.sentences[i])) {\n          temp = temp.slice(this.props.article.sentences[i].length).trim();\n          if (start === -1) start = i;\n          if (temp.length === 0) {\n            end = i;\n            break;\n          }\n        } else {\n          start = -1;\n          temp = paragraph.trim();\n        }\n      }\n\n      for (let i = start; i <= end; i++) {\n        sentences.push(i);\n      }\n      this.props.updateParagraphToSentencesMap(article, index, sentences);\n    }\n\n    return (\n      <p key={`paragraph-${index}`}>\n        {sentences.map((index) => (\n          <span key={`sentence-${index}`}>\n            <Sentence\n              articleId={articleId}\n              category={category}\n              sentenceIndex={index}\n              plainText={displayOnly}\n            />\n            {' '}\n          </span>\n        ))}\n      </p>\n    );\n  }\n\n  blockContextMenu = (event: MouseEvent) => event.preventDefault();\n\n  render() {\n    if (!this.props.article) return <div className=\"article-container\" />;\n    if (this.props.displayOnly) {\n      return (\n        <div className=\"article-container not-so-smooth\">\n          {this.props.article.paragraphs.map((paragraph, index) => (\n            this.getParagraph(paragraph, index)\n          ))}\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"article-container\" onContextMenu={this.blockContextMenu} ref={this.ref}>\n        <ColorLegend \n          articleId=\"1\"\n          annotators={this.props.annotators}\n        />\n        {this.props.article.paragraphs.map((paragraph, index) => (\n          this.getParagraph(paragraph, index)\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default connector(Article);\n","import React from 'react';\nimport { RouteComponentProps, withRouter } from 'react-router-dom';\nimport Article from './Article';\n\ntype ArticleCardProps = RouteComponentProps & {\n  articleId: number,\n  category: string,\n  style?: any,\n  shouldNotRenderInFull?: boolean,\n}\n\ntype ArticleCardState = {\n  hasRenderedInFull: boolean\n}\n\nclass ArticleCard extends React.Component<ArticleCardProps, ArticleCardState> {\n  constructor(props: ArticleCardProps) {\n    super(props);\n    this.state = { hasRenderedInFull: !this.props.shouldNotRenderInFull };\n  }\n\n  componentDidUpdate(props: ArticleCardProps) {\n    if (this.state.hasRenderedInFull) return;\n    if (!props.shouldNotRenderInFull) {\n      this.setState({ hasRenderedInFull: true });\n    }\n  }\n\n  handleClick = () => {\n    this.props.history.push(`/${this.props.category}/${this.props.articleId}`);\n  }\n\n  render() {\n    if (this.props.shouldNotRenderInFull && !this.state.hasRenderedInFull) {\n      return (\n        <div\n          className=\"article-card-container\"\n          style={this.props.style}>\n          <div className=\"article-container\" style={{ backgroundColor: '#fff' }} />\n          <span>Article {this.props.articleId}</span>\n        </div>\n      );\n    }\n\n    return (\n      <div\n        onClick={this.handleClick}\n        className=\"article-card-container\"\n        style={this.props.style}>\n        <Article {...this.props} displayOnly={true} />\n        <div className=\"article-container-mask\" />\n        <span>Article {this.props.articleId}</span>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(ArticleCard);\n","import React from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { AutoSizer, Grid, GridCellRenderer } from 'react-virtualized';\nimport { RouteComponentProps, withRouter, Link } from 'react-router-dom';\nimport { StateType, getArticleIdList, getCurrentArticle, getUsername } from '../store';\nimport socket, { fetchArticleList } from '../socket';\nimport ArticleCard from './ArticleCard';\n\ntype ArticleCardPanelProps = {\n  category: string,\n}\n\nconst mapStateToProps = (state: StateType, props: ArticleCardPanelProps & RouteComponentProps) => ({\n  articleIds: getArticleIdList((props.match.params as any).category)(state),\n  category: (props.match.params as any).category,\n  currentArticle: getCurrentArticle(state),\n  username: getUsername(state),\n});\n\nconst connector = connect(mapStateToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\ntype PropsType = ArticleCardPanelProps & PropsFromRedux;\n\ntype ArticleCardPanelState = {\n  annotatedArticleCount: number;\n}\n\nconst elementHeight = 360;\nconst elementWidth = 240;\n\nclass ArticleCardPanel extends React.Component<PropsType, ArticleCardPanelState> {\n  ref = React.createRef<HTMLDivElement>();\n  columnCount = 0;\n\n  constructor(props: PropsType) {\n    super(props);\n\n    this.state = {\n      annotatedArticleCount: -1,\n    };\n  }\n\n  componentDidMount() {\n    fetchArticleList(this.props.category);\n    this.updateAnnotatedArticleCount();\n    setTimeout(() => {\n      if (this.props.currentArticle && this.props.category === this.props.currentArticle.category) {\n        if (this.ref && this.ref.current && this.ref.current.parentElement) {\n          const parent = this.ref.current.parentElement.parentElement;\n          if (parent === null) return;\n          const index = this.props.articleIds.indexOf(this.props.currentArticle.articleId);\n          parent.scrollTo(0, Math.floor(index / this.columnCount) * elementHeight - 100);\n        }\n      }\n    }, 0);\n  }\n\n  componentDidUpdate() {\n    this.updateAnnotatedArticleCount();\n  }\n\n  updateAnnotatedArticleCount() {\n    socket.emit('get annotated article count', {\n      category: this.props.category,\n      annotator: this.props.username,\n    }, (count: number) => {\n      this.setState({ annotatedArticleCount: count });\n    });\n  }\n\n  getArticleCard: GridCellRenderer = ({ columnIndex, rowIndex, style, key, parent, isVisible }) => {\n    const index = columnIndex + rowIndex * this.columnCount;\n    if (index >= this.props.articleIds.length) {\n      return <div style={style} key={key} />;\n    }\n    const articleId = this.props.articleIds[index];\n\n    return (\n      <div key={key} ref={this.ref} style={{\n        ...style,\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'flex-start',\n      }}>\n        <ArticleCard\n          category={this.props.category}\n          articleId={articleId}\n          shouldNotRenderInFull={!isVisible}\n          style={{ width: '12rem' }} />\n      </div>\n    );\n  };\n\n  render() {\n    return (\n      <div style={{ width: '100%', height: '100vh' }}>\n        <Link to=\"/\" style={{\n          padding: '.25rem 1rem',\n          textDecoration: 'none',\n          color: '#333',\n          position: 'fixed',\n          top: '0',\n          backgroundColor: 'rgba(255, 255, 255, .8)',\n          zIndex: 1000000,\n        }}>Go Back</Link>\n        {this.state.annotatedArticleCount < 0 || (\n          <span style={{\n            padding: '.25rem 1rem',\n            textDecoration: 'none',\n            color: '#333',\n            position: 'fixed',\n            top: '0',\n            right: '0',\n            backgroundColor: 'rgba(255, 255, 255, .8)',\n            zIndex: 1000000,\n          }}>{this.state.annotatedArticleCount} / {(this.props.articleIds || []).length}</span>\n        )}\n        <AutoSizer>\n          {({ height, width }) => {\n            this.columnCount = Math.floor(width / elementWidth);\n            return (\n              <Grid\n                className=\"article-card-panel-container\"\n                cellRenderer={this.getArticleCard.bind(this)}\n                width={width}\n                height={height}\n                columnWidth={(width - 32) / this.columnCount}\n                columnCount={this.columnCount}\n                rowHeight={elementHeight}\n                rowCount={Math.ceil((this.props.articleIds || []).length / this.columnCount)} />\n            );\n          }}\n        </AutoSizer>\n      </div>\n    );\n  }\n}\n\nexport default withRouter(connector(ArticleCardPanel));\n","import React from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { fetchCategoryList } from '../socket';\nimport { StateType } from '../store';\n\nconst mapStateToProps = (state: StateType) => ({\n  categories: state.utils.categories,\n});\nconst connector = connect(mapStateToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nclass CategoryPanel extends React.Component<PropsFromRedux> {\n  componentDidMount() {\n    fetchCategoryList();\n  }\n\n  render() {\n    return (\n      <div className=\"category-panel\">\n        {this.props.categories.map(category => (\n          <Link\n            to={`/${category}`}\n            key={category}\n            className=\"category-card\">\n            {category}\n          </Link>\n        ))}\n      </div>\n    );\n  }\n}\n\nexport default connector(CategoryPanel);\n","import React, { ChangeEvent } from 'react';\nimport { Dispatch } from 'redux';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { CHANGE_USERNAME } from '../store';\nimport { createHighlightStyle } from '../utils';\n\nconst mapDispatchToProps = (dispatch: Dispatch) => ({\n  setUsername: (username: string) => {\n    dispatch({\n      type: CHANGE_USERNAME,\n      username,\n    });\n  }\n});\n\nconst connector = connect(null, mapDispatchToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\ntype SetUsernameState = {\n  username: string;\n}\n\nclass SetUsername extends React.Component<PropsFromRedux, SetUsernameState> {\n  constructor(props: PropsFromRedux) {\n    super(props);\n    this.state = { username: '' };\n    this.handleChange = this.handleChange.bind(this);\n    this.changeUsername = this.changeUsername.bind(this);\n  }\n\n  handleChange(event: ChangeEvent<HTMLInputElement>) {\n    this.setState({ username: event.target.value });\n  }\n\n  changeUsername() {\n    if (!this.props.setUsername) return;\n    this.props.setUsername(this.state.username);\n    createHighlightStyle(this.state.username);\n  }\n\n  render() {\n    return (\n      <div className=\"username-container\">\n        <input\n          placeholder=\"Username\"\n          className=\"username-input\"\n          onKeyPress={(event: React.KeyboardEvent) => { if (event.key === 'Enter') this.changeUsername() }}\n          onChange={this.handleChange} />\n        <span\n          className=\"username-button\"\n          onClick={this.changeUsername}>\n          Set Username\n        </span>\n      </div>\n    );\n  }\n}\n\nexport default connector(SetUsername);\n","import React from 'react';\nimport { connect, ConnectedProps } from 'react-redux';\nimport { Switch, Route, withRouter, RouteComponentProps } from 'react-router-dom';\nimport store, { StateType, isUserLoggedIn, getUsername, DISPLAY_OTHERS_ANNOTATION } from './store';\nimport { AnnotationPanel, ArticleCardPanel, CategoryPanel, SetUsername } from './components'\nimport { createHighlightStyle } from './utils';\n\ndeclare global {\n  interface Window { displayOthersAnnotation: () => void; }\n}\n\nwindow.displayOthersAnnotation = () => {\n  store.dispatch({\n    type: DISPLAY_OTHERS_ANNOTATION,\n  });\n}\n\nconst mapStateToProps = (state: StateType) => ({\n  isUserLoggedIn: isUserLoggedIn(state),\n  username: getUsername(state),\n});\n\nconst connector = connect(mapStateToProps);\ntype PropsFromRedux = ConnectedProps<typeof connector>;\n\nclass App extends React.Component<PropsFromRedux & RouteComponentProps> {\n  componentDidMount() {\n    if (this.props.isUserLoggedIn && this.props.username) {\n      createHighlightStyle(this.props.username);\n    }\n  }\n\n  render() {\n    if (!this.props.isUserLoggedIn) {\n      return <SetUsername />;\n    }\n\n    return (\n      <Switch>\n        <Route path=\"/:category/:articleId\" component={AnnotationPanel} />\n        <Route path=\"/:category\" component={ArticleCardPanel} />\n        <Route path=\"/\" component={CategoryPanel} />\n      </Switch>\n    );\n  }\n}\n\nexport default withRouter(connector(App));\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router } from 'react-router-dom';\nimport './index.css';\nimport App from './App';\nimport { Provider } from 'react-redux';\nimport store from './store';\nimport { addBackgroundCss } from './utils';\nimport * as serviceWorker from './serviceWorker';\nimport { frontend } from './config';\n\naddBackgroundCss();\n\nconst baseUrl = new URL(frontend);\n\nReactDOM.render(\n  <Provider store={store}>\n    <Router basename={baseUrl.pathname.slice(1)}>\n      <App />\n    </Router>\n  </Provider>,\n  document.getElementById('root'),\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}